<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - RAASH</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo"><img src="images/logo.png" alt="RAASH Logo"></div>
            <ul class="nav-links">
                <li><a href="admin-dashboard.html">Dashboard</a></li>
                <li><a href="admin-products.html">Products</a></li>
                <li><a href="admin-orders.html">Orders</a></li>
                <li><a href="admin-users.html">Users</a></li>
                <li id="authButtonContainer">
                    <a href="admin-login.html" id="loginBtn" class="login-btn">Admin Login</a>
                    <a href="#" id="logoutBtn" class="login-btn" style="display: none;">Logout</a>
                </li>
            </ul>
        </div>
    </nav>

    <section class="admin-content">
        <div id="adminLoginContainer">
            <h2>Admin Login</h2>
            <form id="adminLoginForm">
                <label for="adminEmail">Email:</label>
                <input type="email" id="adminEmail" required>
                <label for="adminPassword">Password:</label>
                <input type="password" id="adminPassword" required>
                <button type="submit">Login</button>
            </form>
            <p id="adminLoginMessage"></p>
        </div>

        <div id="adminDashboard" style="display: none;">
            <!-- Admin dashboard content will be loaded here -->
        </div>
    </section>

    <footer class="footer">
        <div class="footer-container">
            <div class="footer-section">
                <h3>About Us</h3>
                <p>RAASH is your one-stop e-commerce platform for all your shopping needs.</p>
            </div>
            <div class="footer-section">
                <h3>Help</h3>
                <ul>
                    <li><a href="#">FAQs</a></li>
                    <li><a href="#">Shipping & Returns</a></li>
                    <li><a href="#">Contact Support</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Follow Us</h3>
                <div class="social-links">
                    <a href="https://facebook.com" target="_blank"><i class="fa-brands fa-facebook"></i></a>
                    <a href="https://twitter.com" target="_blank"><i class="fa-brands fa-twitter"></i></a>
                    <a href="https://instagram.com" target="_blank"><i class="fa-brands fa-instagram"></i></a>
                    <a href="https://linkedin.com" target="_blank"><i class="fa-brands fa-linkedin"></i></a>
                    <a href="https://youtube.com" target="_blank"><i class="fa-brands fa-youtube"></i></a>
                </div>
            </div>
            <div class="footer-section">
                <h3>Address</h3>
                <p>123, RAASH Street, E-Commerce City, Country</p>
            </div>
        </div>
        <div class="copyright">
            <p>Â© 2025 RAASH. All rights reserved.</p>
        </div>
    </footer>

    <script>
        document.getElementById("adminLoginForm").addEventListener("submit", async (e) => {
            e.preventDefault();
            const email = document.getElementById("adminEmail").value.trim();
            const password = document.getElementById("adminPassword").value;

            try {
                const response = await fetch('/admin/login', {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json();
                if (response.ok) {
                    document.getElementById("adminLoginContainer").style.display = "none";
                    document.getElementById("adminDashboard").style.display = "block";
                    loadAdminDashboard();
                } else {
                    showMessage(data.error, "error");
                }
            } catch (error) {
                showMessage("Network error. Please try again.", "error");
                console.error("Error:", error);
            }
        });

        function showMessage(message, type) {
            const messageElement = document.getElementById("adminLoginMessage");
            messageElement.textContent = message;
            messageElement.className = type;
        }

        function loadAdminDashboard() {
            // Load admin dashboard content
            document.getElementById("adminDashboard").innerHTML = `
                <h2>Admin Dashboard</h2>
                <div class="admin-stats">
                    <div class="stat-card">
                        <h3>Total Products</h3>
                        <p id="totalProducts">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Total Orders</h3>
                        <p id="totalOrders">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Total Users</h3>
                        <p id="totalUsers">0</p>
                    </div>
                </div>
                <div class="admin-actions">
                    <button onclick="location.href='admin-products.html'">Manage Products</button>
                    <button onclick="location.href='admin-orders.html'">Manage Orders</button>
                    <button onclick="location.href='admin-users.html'">Manage Users</button>
                </div>
            `;
            
            // Fetch stats
            fetch('/admin/stats')
                .then(response => response.json())
                .then(data => {
                    document.getElementById("totalProducts").textContent = data.products;
                    document.getElementById("totalOrders").textContent = data.orders;
                    document.getElementById("totalUsers").textContent = data.users;
                });
        }

        // Check if admin is already logged in
        fetch('/admin/check-auth')
            .then(response => response.json())
            .then(data => {
                if (data.authenticated) {
                    document.getElementById("adminLoginContainer").style.display = "none";
                    document.getElementById("adminDashboard").style.display = "block";
                    loadAdminDashboard();
                }
            });
    </script>
</body>
</html>